<div class="mkb-account">

  <div class="mkb-view row-fluid" ng-show="account.user.nickName" ng-controller="AssetsCtrl">
    <div class="span4">
      <jq-grid options="account.userCardsGrid"></jq-grid>
    </div>
    <div class="span4">
      <table class="table table-bordered table-striped">
        <tbody>
        <tr>
          <td><strong>昵称</strong></td>
          <td>{{account.user.nickName}}<a class="btn btn-mini btn-info pull-right" ng-click="account.refreshUserInfo(true)">刷新</a><a class="btn btn-mini pull-right" ng-click="account.logout()">登出</a></td>
        </tr>
        <tr>
          <td><strong>等级</strong></td>
          <td>{{account.user.level}} <span class="badge">{{((account.user.exp - account.user.prevExp) / (account.user.nextExp - account.user.prevExp) * 100).toFixed(2)}}%</span></td>
        </tr>
        <tr>
          <td><strong>邀请码</strong></td>
          <td>{{account.user.inviteCode}}</td>
        </tr>
        <tr>
          <td><strong>行动点</strong></td>
          <td>{{account.user.energy}}/{{account.user.energyMax}}</td>
        </tr>
        <tr>
          <td><strong>金币</strong></td>
          <td>{{account.user.coins}}</td>
        </tr>
        <tr>
          <td><strong>晶钻</strong></td>
          <td>{{account.user.cash}}</td>
        </tr>
        <tr>
          <td><strong>魔幻券</strong></td>
          <td>{{account.user.ticket}}</td>
        </tr>
        <tr>
          <td><strong>竞技场</strong></td>
          <td>胜利：{{account.user.win}} 失败：{{account.user.lose}} <span ng-show="account.user.win + account.user.lose" class="badge">{{(account.user.win / (account.user.win + account.user.lose) * 100).toFixed(2)}}%</span></td>
          </td>
        </tr>
        </tbody>
      </table>
      <div class="alert alert-info">
        <strong>游戏设定</strong>
        <a ng-click="account.refreshAssets(account.username)"><i class="icon-refresh"></i></a>

        <div class="row-fluid">
          <a class="btn btn-info span3">地图</a>
          <a class="btn btn-info span3">技能</a>
          <a href="#modal_assets_cards" role="button" data-toggle="modal" class="btn btn-info span3">卡牌</a>
          <a class="btn btn-info span3">符文</a>
        </div>
      </div>
      <div class="alert alert-block">
        <strong>一键操作</strong>

        <div class="row-fluid">
          <a class="btn btn-warning span3" ng-click="account.getMazeStatus()" href="#modal_account_maze" role="button" data-toggle="modal">清理迷宫{{assets.maps.length}}</span></a>
          <a class="btn btn-warning span3">清理反攻{{assets.skills.length}}</span></a>
          <a class="btn btn-warning span3" ng-click="account.getGoodsList()" href="#modal_account_goods" role="button" data-toggle="modal">购买卡牌</a>
          <a class="btn btn-warning span3">强化卡牌</a>
        </div>
      </div>

    </div>
    <div class="span4">
      <jq-grid options="account.userFriendsGrid"></jq-grid>
    </div>
  </div>

  <div id="modal_assets_cards" class="modal hide fade" tabindex="-1" role="dialog">
    <jq-grid options="account.cardDefsGrid"></jq-grid>
  </div>

  <div id="modal_account_maze" class="modal hide fade" tabindex="-1" role="dialog">
    <h3 ng-hide="account.mazeStatus">正在读取迷宫进度……</h3>
    <table ng-show="account.mazeStatus" class="table table-bordered">
      <tr ng-repeat="(id, value) in account.mazeStatus">
        <td>{{value.name}}<span ng-show="value.freeReset" ng-click="account.resetMaze(id)" class="label label-success">免费重置</span><span ng-hide="value.freeReset" ng-click="account.resetMaze(id)" class="label label-warning">{{value.resetCash}}晶钻</span></td>
        <td>当前进度：<strong ng-show="value.clear">已通关</strong><strong ng-hide="value.clear">第{{value.layer}}层</strong><a ng-hide="value.clear" ng-click="account.clearMaze(id)" class="btn btn-info btn-mini">继续</a></td>
      </tr>
    </table>

    <form ng-show="account.mazeStatus" class="form-horizontal">
      <div class="control-group">
        <label class="control-label" for="maze_max_try">允许战斗失败次数</label>
        <div class="controls">
          <input type="text" id="maze_max_try" ng-model="account.maxTry" required>
        </div>
      </div>
      <div class="control-group">
        <label class="control-label" for="maze_energy">行动点</label>
        <div class="controls">
          <input class="span3" id="maze_energy" ng-model="account.user.energy" type="text" disabled>
          <button class="btn btn-warning" type="button">购买</button>
          <button class="btn btn-info" type="button" ng-click="account.refreshUserInfo(true)">刷新</button>
        </div>
      </div>
    </form>

  </div>

  <div id="modal_account_goods" class="modal hide fade" tabindex="-1" role="dialog">
  </div>

  <div ng-hide="account.user.nickName" id="modal-login" class="modal show">
    <div class="modal-header">
      <h4>Login</h4>
    </div>
    <div class="modal-body">
      <form class="form-horizontal">
        <div class="control-group">
          <label class="control-label" for="account_username">Username</label>

          <div class="controls">
            <input type="text" ng-model="account.username" id="account_username" placeholder="Username">
          </div>
        </div>
        <div class="control-group">
          <label class="control-label" for="account_password">Password</label>

          <div class="controls">
            <input type="password" ng-model="account.password" id="account_password" placeholder="Maybe I know it...?">
          </div>
        </div>
        <div class="control-group">
          <div class="controls">
            <label class="checkbox">
              <input ng-model="account.remember" type="checkbox"> Remember me
            </label>
            <button type="submit" ng-click="account.login()" class="btn">Sign in</button>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>